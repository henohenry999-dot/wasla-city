<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØµÙ„Ø© | Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§ØµÙ…Ø©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #1e3799;       
            --secondary: #4cd137;     
            --accent: #fbc531;        
            --dark: #2f3640;
            --light: #f5f6fa;
            --white: #ffffff;
        }

        body { font-family: 'Cairo', sans-serif; margin: 0; background-color: var(--light); color: var(--dark); padding-bottom: 90px; }
        a { text-decoration: none; }

        /* --- 1. Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ø¨Ø§Ù†Ø± (ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹) --- */
        header { background: linear-gradient(135deg, #0c2461, #1e3799); color: white; padding-bottom: 20px; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; position: relative; overflow: hidden; }
        .nav-bar { display: flex; justify-content: space-between; align-items: center; padding: 20px; }
        .logo { font-size: 1.8rem; font-weight: 900; }
        .logo span { color: var(--accent); }
        .btn-add { background: var(--accent); color: var(--primary); padding: 8px 15px; border-radius: 50px; font-weight: bold; font-size: 0.9rem; box-shadow: 0 4px 15px rgba(251, 197, 49, 0.3); transition: 0.3s; }
        
        .hero-section { text-align: center; padding: 20px 10px 40px; }
        .hero-title { font-size: 2rem; margin: 0 0 10px; font-weight: 900; }
        .hero-subtitle { opacity: 0.9; font-size: 1.1rem; margin-bottom: 20px; }
        
        /* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© */
        .stats-bar { display: flex; justify-content: center; gap: 20px; margin-top: 15px; }
        .stat-item { background: rgba(255,255,255,0.1); padding: 10px 20px; border-radius: 15px; backdrop-filter: blur(5px); }
        .stat-num { font-weight: bold; font-size: 1.2rem; display: block; }
        .stat-label { font-size: 0.8rem; opacity: 0.8; }

        /* --- 2. Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ² (Ø¬Ø¯ÙŠØ¯) --- */
        .featured-section { padding: 20px 15px 0; }
        .section-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .section-title i { color: var(--accent); }
        
        .featured-slider { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; }
        .featured-slider::-webkit-scrollbar { display: none; }
        
        .ad-card { min-width: 280px; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 2px solid var(--accent); position: relative; }
        .ad-badge { position: absolute; top: 10px; right: 10px; background: var(--accent); color: var(--primary); padding: 4px 10px; border-radius: 20px; font-weight: bold; font-size: 0.7rem; z-index: 2; }
        .ad-img { width: 100%; height: 140px; object-fit: cover; }
        .ad-body { padding: 10px; }
        .ad-title { margin: 0; font-size: 1.1rem; color: var(--primary); }
        
        /* --- 3. Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙ†ÙŠÙØ§Øª --- */
        .search-wrapper { margin: -25px 15px 20px; background: white; padding: 10px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); display: flex; gap: 10px; position: relative; z-index: 10; }
        .search-box { flex: 1; border: none; outline: none; padding: 10px; font-family: 'Cairo'; font-size: 1rem; }
        .filter-btn { background: var(--light); border: none; width: 40px; border-radius: 10px; cursor: pointer; color: var(--primary); }

        .categories-wrapper { overflow-x: auto; white-space: nowrap; padding: 0 15px 20px; scrollbar-width: none; }
        .cat-chip { display: inline-block; padding: 10px 20px; background: white; border: 1px solid #eee; border-radius: 50px; margin-left: 10px; cursor: pointer; transition: 0.3s; color: #555; font-weight: 600; }
        .cat-chip.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 5px 15px rgba(30, 55, 153, 0.2); }

        /* --- 4. Ø§Ù„Ø´Ø¨ÙƒØ© (Grid) --- */
        .container { padding: 0 15px; display: grid; grid-template-columns: repeat(auto-fill, minmax(100%, 1fr)); gap: 15px; }
        @media (min-width: 600px) { .container { grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); } }
        
        .card { background: white; border-radius: 15px; padding: 10px; display: flex; gap: 15px; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.03); transition: 0.2s; border: 1px solid transparent; cursor: pointer; }
        .card:hover { transform: translateY(-3px); border-color: var(--primary); }
        .card-thumb { width: 80px; height: 80px; border-radius: 12px; object-fit: cover; background: #eee; }
        .card-info { flex: 1; }
        .card-info h3 { margin: 0 0 5px; font-size: 1rem; color: var(--dark); }
        .card-meta { font-size: 0.8rem; color: #888; display: flex; gap: 10px; }
        .card-meta i { color: var(--secondary); }
        .rating-stars { color: #f1c40f; font-size: 0.8rem; }

        /* --- 5. Ø§Ù„ÙÙˆØªØ± (Footer) --- */
        footer { text-align: center; padding: 40px 20px; color: #888; font-size: 0.9rem; margin-top: 30px; border-top: 1px solid #ddd; }
        
        /* --- Ø¹Ù†Ø§ØµØ± Ø£Ø®Ø±Ù‰ --- */
        .loading-msg { text-align: center; padding: 50px; color: var(--primary); width: 100%; }
        .fab { position: fixed; bottom: 20px; left: 20px; background: var(--secondary); color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 5px 20px rgba(76, 209, 55, 0.4); z-index: 99; }
        
        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; overflow-y: auto; }
        .modal-content { background: white; margin: 10% auto; width: 90%; max-width: 500px; border-radius: 20px; overflow: hidden; position: relative; animation: slideUp 0.3s; }
        @keyframes slideUp { from {transform:translateY(50px);opacity:0} to {transform:translateY(0);opacity:1} }
    </style>
</head>
<body>

<header>
    <div class="nav-bar">
        <div class="logo">ÙˆØµÙ„Ø© <span>.</span></div>
        <a href="https://forms.gle/iGmmzXMt9amqkepu7" target="_blank" class="btn-add">+ Ø£Ø¶Ù Ù…ÙƒØ§Ù†Ùƒ</a>
    </div>
    <div class="hero-section">
        <h1 class="hero-title">Ù…Ø¯ÙŠÙ†ØªÙƒ ÙƒÙ„Ù‡Ø§ ÙÙŠ Ø¬ÙŠØ¨Ùƒ ğŸ“±</h1>
        <p class="hero-subtitle">Ø¯Ù„ÙŠÙ„ Ø®Ø¯Ù…Ø§Øª Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù† Ø§Ù„Ø³ÙƒØ§Ù† Ù„Ù„Ø³ÙƒØ§Ù†</p>
        
        <div class="stats-bar">
            <div class="stat-item"><span class="stat-num" id="countPlaces">0</span><span class="stat-label">Ù…ÙƒØ§Ù†</span></div>
            <div class="stat-item"><span class="stat-num">24/7</span><span class="stat-label">Ù…ØªØ§Ø­</span></div>
            <div class="stat-item"><span class="stat-num">100%</span><span class="stat-label">Ù…Ø¬Ø§Ù†ÙŠ</span></div>
        </div>
    </div>
</header>

<div class="search-wrapper">
    <input type="text" id="searchInput" class="search-box" placeholder="Ø¨ØªØ¯ÙˆØ± Ø¹Ù„Ù‰ Ø¥ÙŠÙ‡ Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ø©ØŸ">
    <button class="filter-btn"><i class="fas fa-search"></i></button>
</div>

<div id="featuredSection" class="featured-section" style="display:none;">
    <div class="section-title"><i class="fas fa-crown"></i> Ù…Ø­Ù„Ø§Øª Ù…Ù…ÙŠØ²Ø© ÙˆÙ…ÙˆØµÙ‰ Ø¨Ù‡Ø§</div>
    <div class="featured-slider" id="featuredContainer">
        </div>
</div>

<div class="categories-wrapper">
    <div class="cat-chip active" onclick="filterData('all', this)">Ø§Ù„ÙƒÙ„</div>
    <div class="cat-chip" onclick="filterData('food', this)">ğŸ” Ù…Ø·Ø§Ø¹Ù…</div>
    <div class="cat-chip" onclick="filterData('market', this)">ğŸ›’ Ù…Ø§Ø±ÙƒØª</div>
    <div class="cat-chip" onclick="filterData('medical', this)">ğŸ’Š Ø·Ø¨ÙŠØ©</div>
    <div class="cat-chip" onclick="filterData('maintenance', this)">ğŸ”§ ØµÙŠØ§Ù†Ø©</div>
    <div class="cat-chip" onclick="filterData('transport', this)">ğŸšŒ Ù…ÙˆØ§ØµÙ„Ø§Øª</div>
    <div class="cat-chip" onclick="filterData('education', this)">ğŸ“ ØªØ¹Ù„ÙŠÙ…</div>
</div>

<div class="featured-section">
    <div class="section-title"><i class="fas fa-list"></i> ÙƒÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</div>
    <div class="container" id="gridContainer">
        <div class="loading-msg"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ù„ÙŠÙ„...</div>
    </div>
</div>

<a href="https://wa.me/?text=ØªØ·Ø¨ÙŠÙ‚ ÙˆØµÙ„Ø© Ø±Ø§Ø¦Ø¹ Ù„Ø®Ø¯Ù…Ø§Øª Ù…Ø¯ÙŠÙ†ØªÙ†Ø§" class="fab"><i class="fab fa-whatsapp"></i></a>

<footer>
    <p>ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ø­Ø¨ â¤ï¸ Ù„Ø®Ø¯Ù…Ø© Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§ØµÙ…Ø©</p>
    <p style="font-size:0.8rem; opacity:0.6;">Â© 2025 Ù…Ù†ØµØ© ÙˆØµÙ„Ø©</p>
</footer>

<div id="modal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal()" style="position:absolute; top:15px; left:15px; background:rgba(0,0,0,0.5); color:white; width:30px; height:30px; text-align:center; line-height:30px; border-radius:50%; cursor:pointer; z-index:10;">âœ•</span>
        <img id="mImg" src="" style="width:100%; height:250px; object-fit:cover;">
        <div style="padding:20px;">
            <h2 id="mName" style="color:var(--primary); margin:0;"></h2>
            <div style="margin:10px 0;"><span id="mCat" style="background:#eee; padding:3px 10px; border-radius:10px; font-size:0.8rem;"></span></div>
            <p id="mDesc" style="color:#555; line-height:1.6;"></p>
            <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
            <div style="display:flex; gap:10px;">
                <a id="mCall" href="#" class="btn-add" style="flex:1; text-align:center; background:var(--secondary); color:white;"><i class="fas fa-phone"></i> Ø§ØªØµØ§Ù„</a>
                <a id="mWa" href="#" class="btn-add" style="flex:1; text-align:center; background:var(--primary); color:white;"><i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨</a>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    // Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    const rawSheet = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQxk-tGJ65-hOGtlnVUHDmDUohw1zFIFLDlIng-OlmH35mti_kqInGBCl3gNpUUeL9j5VRMx_x7A8bn/pub?output=csv";
    const proxyURL = "https://api.allorigins.win/raw?url=" + encodeURIComponent(rawSheet);

    let allData = [];
    const grid = document.getElementById('gridContainer');
    const featuredCont = document.getElementById('featuredContainer');
    const modal = document.getElementById('modal');

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø­Ø³Ù†Ø© (Ù…Ø¹ Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø­Ø¸Ø±)
    function fixImg(url) {
        if (!url || url.length < 5) return 'https://via.placeholder.com/150?text=No+Image';
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ ID Ù…Ù† Ø±Ø§Ø¨Ø· Ø¯Ø±Ø§ÙŠÙ
        let id = "";
        if(url.includes('id=')) id = url.split('id=')[1].split('&')[0];
        else if(url.includes('/d/')) id = url.split('/d/')[1].split('/')[0];
        
        if(id) return `https://lh3.googleusercontent.com/d/${id}=s600`; // Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø³ÙŠØ±ÙØ±Ø§Øª Ø¬ÙˆØ¬Ù„ Ù„Ù„ØµÙˆØ±
        return url;
    }

    function init() {
        Papa.parse(proxyURL, {
            download: true,
            header: false, // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±ØªÙŠØ¨)
            skipEmptyLines: true,
            complete: function(res) {
                const rows = res.data.slice(1); // Ø­Ø°Ù ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
                allData = rows.map((row, i) => ({
                    id: i,
                    name: row[1],          // Ø¹Ù…ÙˆØ¯ B
                    cat:  mapCat(row[2]),  // Ø¹Ù…ÙˆØ¯ C
                    area: row[3],          // Ø¹Ù…ÙˆØ¯ D
                    desc: row[4],          // Ø¹Ù…ÙˆØ¯ E
                    phone: row[5],         // Ø¹Ù…ÙˆØ¯ F
                    wa:   row[6],          // Ø¹Ù…ÙˆØ¯ G
                    img:  fixImg(row[7]),  // Ø¹Ù…ÙˆØ¯ H
                    feat: (row[8] && (row[8].includes('TRUE') || row[8].includes('Ù†Ø¹Ù…'))) // Ø¹Ù…ÙˆØ¯ I
                })).filter(x => x.name);

                document.getElementById('countPlaces').innerText = allData.length;
                render();
            },
            error: () => grid.innerHTML = "<p style='text-align:center; color:red'>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±</p>"
        });
    }

    function mapCat(c) {
        if(!c) return "other";
        if(c.includes("Ù…Ø·Ø§Ø¹Ù…")) return "food";
        if(c.includes("Ù…Ø§Ø±ÙƒØª")) return "market";
        if(c.includes("Ø·Ø¨")) return "medical";
        if(c.includes("ØµÙŠØ§Ù†Ø©")) return "maintenance";
        if(c.includes("Ù…ÙˆØ§ØµÙ„Ø§Øª")) return "transport";
        if(c.includes("ØªØ¹Ù„ÙŠÙ…")) return "education";
        return "other";
    }

    function render(cat = 'all', search = '') {
        grid.innerHTML = '';
        featuredCont.innerHTML = '';
        let hasFeatured = false;

        const filtered = allData.filter(x => {
            return (cat === 'all' || x.cat === cat) && 
                   (x.name.includes(search) || (x.desc && x.desc.includes(search)));
        });

        // 1. Ø±Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© (Slider)
        const featured = filtered.filter(x => x.feat);
        if(featured.length > 0) {
            document.getElementById('featuredSection').style.display = 'block';
            featured.forEach(item => {
                featuredCont.innerHTML += `
                    <div class="ad-card" onclick="openM(${item.id})">
                        <div class="ad-badge">Ø¥Ø¹Ù„Ø§Ù†</div>
                        <img src="${item.img}" class="ad-img" referrerpolicy="no-referrer" onerror="this.src='https://via.placeholder.com/300?text=ØµÙˆØ±Ø©'">
                        <div class="ad-body"><h4 class="ad-title">${item.name}</h4></div>
                    </div>
                `;
            });
        } else {
            document.getElementById('featuredSection').style.display = 'none';
        }

        // 2. Ø±Ø³Ù… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© (Grid)
        if(filtered.length === 0) grid.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬...</p>";
        filtered.forEach(item => {
            // Ø¥Ø¶Ø§ÙØ© referrerpolicy="no-referrer" Ù„Ù„ØµÙˆØ±Ø© Ù‡Ùˆ Ø§Ù„Ø­Ù„ Ø§Ù„Ø³Ø­Ø±ÙŠ
            grid.innerHTML += `
                <div class="card" onclick="openM(${item.id})">
                    <img src="${item.img}" class="card-thumb" referrerpolicy="no-referrer" onerror="this.src='https://via.placeholder.com/150?text=ØµÙˆØ±Ø©'">
                    <div class="card-info">
                        <h3>${item.name}</h3>
                        <div class="rating-stars">â˜…â˜…â˜…â˜…â˜…</div>
                        <div class="card-meta"><i class="fas fa-map-marker-alt"></i> ${item.area || 'Ø¹Ø§Ù…'}</div>
                    </div>
                </div>
            `;
        });
    }

    // ÙÙ„ØªØ±Ø©
    window.filterData = (c, el) => {
        document.querySelectorAll('.cat-chip').forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        render(c, document.getElementById('searchInput').value);
    };

    // Ø¨Ø­Ø«
    document.getElementById('searchInput').addEventListener('input', (e) => {
        const activeCat = document.querySelector('.cat-chip.active').getAttribute('onclick').split("'")[1];
        render(activeCat, e.target.value);
    });

    // Modal
    window.openM = (id) => {
        const item = allData.find(x => x.id === id);
        document.getElementById('mName').innerText = item.name;
        document.getElementById('mImg').src = item.img;
        document.getElementById('mDesc').innerText = item.desc || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ';
        document.getElementById('mCat').innerText = item.area;
        document.getElementById('mCall').href = `tel:${item.phone}`;
        document.getElementById('mWa').href = `https://wa.me/${item.wa}`;
        modal.style.display = 'block';
    };
    window.closeModal = () => modal.style.display = 'none';
    window.onclick = (e) => { if(e.target == modal) closeModal() };

    init();
</script>
</body>
</html>
