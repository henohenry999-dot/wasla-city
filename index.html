<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hona | Ø¯Ù„ÙŠÙ„Ùƒ ÙÙŠ Ø¬ÙŠØ¨Ùƒ</title>
    <meta name="theme-color" content="#27ae60">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&family=Reem+Kufi:wght@700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- V178 ROYAL EDITION: The Most Beautiful Version --- */
        :root { --primary: #27ae60; --dark: #2c3e50; --gold: #f1c40f; --bg: #f4f7f6; --white: #ffffff; --red: #e74c3c; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Tajawal', sans-serif; margin: 0; background-color: var(--bg); padding-bottom: 90px; user-select: none; overflow-x: hidden; color: #333; }
        body.modal-open { overflow: hidden; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #splashScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #27ae60, #2c3e50); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease-out; }
        .rocket-icon { font-size: 5rem; color: white; margin-bottom: 20px; animation: pulse 1.5s infinite; }
        .splash-text { color: white; font-family: 'Reem Kufi'; font-size: 1.5rem; letter-spacing: 2px; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± */
        .ticker-container { position: fixed; top: 0; width: 100%; z-index: 2000; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .news-bar { height: 32px; background: var(--dark); color: white; display: flex; align-items: center; font-size: 0.8rem; }
        .ads-bar { height: 30px; background: #fff9c4; color: black; display: flex; align-items: center; border-bottom: 1px solid #eee; font-size: 0.8rem; }
        .ticker-lbl { padding: 0 15px; font-weight: 800; display: flex; align-items: center; height: 100%; z-index: 2; font-size: 0.7rem; white-space: nowrap; }
        .lbl-news { background: var(--red); color: white; } .lbl-ads { background: var(--gold); color: black; }
        .track { white-space: nowrap; flex: 1; overflow: hidden; }
        .scrolling { display: inline-block; animation: scroll 60s linear infinite; padding-right: 20px; font-weight: 600; cursor: pointer; }
        .ticker-item { display: inline-block; margin-left: 40px; }
        @keyframes scroll { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„ÙØ®Ù… */
        header { margin-top: 62px; background: linear-gradient(135deg, var(--primary), #1abc9c); color: white; padding: 20px 20px 40px; border-radius: 0 0 30px 30px; box-shadow: 0 10px 20px rgba(39, 174, 96, 0.15); display: flex; justify-content: space-between; align-items: center; }
        .logo-area { display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .geo-logo { width: 48px; height: 48px; background: white; border-radius: 14px; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 1.6rem; }
        .app-title h1 { margin: 0; font-size: 2rem; font-family: 'Reem Kufi'; }
        .header-icons { display: flex; gap: 12px; align-items: center; }
        .icon-btn { font-size: 1.4rem; color: white; cursor: pointer; }
        .shop-counter-box { background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.3); }
        .shop-counter-num { font-size: 1.1rem; font-weight: 800; color: var(--gold); display: block; }
        .shop-counter-lbl { font-size: 0.6rem; color: #fff; }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
        #mainView { padding: 0 15px; margin-top: -35px; position: relative; z-index: 10; }
        .search-wrap { background: white; padding: 5px; border-radius: 50px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); display: flex; gap: 10px; margin-bottom: 15px; align-items: center; }
        .search-inp { flex: 1; border: none; padding: 12px 20px; outline: none; font-family: 'Tajawal'; font-size: 1rem; background: transparent; }
        .search-btn { color: var(--primary); padding: 0 20px; cursor: pointer; font-size: 1.2rem; }

        .quick-filters { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .q-chip { background: white; padding: 10px 15px; border-radius: 15px; font-size: 0.85rem; font-weight: bold; cursor: pointer; border: 1px solid #eee; display: flex; align-items: center; gap: 8px; white-space: nowrap; color: #555; }
        .q-chip.active { background: var(--dark); color: white; border-color: var(--dark); } .q-chip.active i { color: var(--gold); }

        .cat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px 10px; background: white; padding: 20px 10px; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.02); }
        .cat-item { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; }
        .cat-icon { width: 50px; height: 50px; border-radius: 18px; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; color: white; transition: 0.2s; }
        .cat-name { font-size: 0.7rem; font-weight: 600; color: #555; text-align: center; }
        .cat-item.active .cat-icon { transform: scale(1.1); border: 2px solid var(--gold); }
        .bg-all{background:var(--dark)}.bg-news{background:#c0392b}.bg-gov{background:#8e44ad}.bg-worship{background:#16a085}.bg-school{background:#2980b9}.bg-food{background:#e67e22}.bg-market{background:#27ae60}.bg-home{background:#7f8c8d}.bg-techs{background:#34495e}.bg-tech{background:#3498db}.bg-fashion{background:#9b59b6}.bg-auto{background:#2c3e50}.bg-decor{background:#f39c12}.bg-med{background:#e74c3c}.bg-sport{background:#d35400}.bg-transport{background:#3498db}.bg-clean{background:#d81b60}.bg-other{background:#95a5a6}

        /* Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø§Øª */
        .sub-cat-nav { display: none; overflow-x: auto; gap: 12px; padding: 10px 5px 20px; margin-bottom: 5px; scrollbar-width: none; white-space: nowrap; }
        .sub-chip { background: white; border: 1px solid #f0f0f0; padding: 10px 24px; border-radius: 50px; font-size: 0.9rem; font-weight: 700; color: #555; cursor: pointer; transition: 0.3s; }
        .sub-chip.active { background: linear-gradient(135deg, var(--primary), #2ecc71); color: white; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3); }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: white; border-radius: 18px; padding: 0; display: flex; flex-direction: column; box-shadow: 0 5px 15px rgba(0,0,0,0.04); position: relative; overflow: hidden; cursor: pointer; border: 1px solid #f0f0f0; transition: transform 0.1s; }
        .card:active { transform: scale(0.98); }
        .card * { pointer-events: none; } .card .card-fav-btn { pointer-events: auto; }
        .card.featured { border: 2px solid var(--gold); background: #fffcf9; }
        .card.news-card { grid-column: span 2; display: flex; flex-direction: row; padding: 10px; border-right: 4px solid var(--red); }
        .card.news-card .c-img { width: 100px; height: 100px; margin-left: 10px; border-radius: 12px; }
        .c-img { width: 100%; height: 120px; object-fit: cover; background: #eee; display: block; border-bottom: 1px solid #f0f0f0; }
        .c-body { padding: 10px; flex: 1; }
        .c-title { margin: 0 0 6px; font-size: 1rem; font-weight: 900; color: #333; }
        .c-sub { font-size: 0.75rem; color: #444; display: flex; align-items: center; gap: 5px; font-weight: 700; margin-bottom: 6px; }
        .c-sub i { color: var(--primary); }
        .card-offer-visible { background: #fff5f5; color: var(--red); font-size: 0.75rem; font-weight: 800; padding: 6px 8px; border-radius: 8px; display: inline-block; margin-top: 5px; border: 1px dashed #ffe0e0; }
        .badge-feat { position: absolute; top: 0; left: 0; background: var(--gold); color: black; padding: 4px 10px; border-radius: 0 0 10px 0; font-size: 0.65rem; font-weight: bold; z-index: 4; }
        .card-fav-btn { position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.95); width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 3px 8px rgba(0,0,0,0.15); z-index: 10; color: #bdc3c7; cursor: pointer; }
        .card-fav-btn.active { color: var(--red); }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© ÙˆØ§Ù„Ù‡Ø¯ÙŠØ© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
        .btm-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 10px 0 25px; display: flex; justify-content: space-around; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); z-index: 1000; border-radius: 25px 25px 0 0; }
        .btm-item { text-align: center; color: #bdc3c7; font-size: 0.65rem; cursor: pointer; min-width: 55px; }
        .btm-item.active { color: var(--primary); font-weight: bold; transform: translateY(-5px); }
        .btm-item i { font-size: 1.3rem; display: block; margin-bottom: 4px; }
        .fab { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 65px; height: 65px; background: var(--dark); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; border: 5px solid white; box-shadow: 0 5px 20px rgba(0,0,0,0.2); z-index: 1100; cursor: pointer; transition: 0.3s; }
        
        .float-ad { position: fixed; top: 160px; left: -5px; z-index: 3000; background: white; border: 2px solid var(--gold); border-left: none; border-radius: 0 20px 20px 0; padding: 5px; width: 45px; height: 45px; display: flex; align-items: center; cursor: pointer; transition: 0.3s; box-shadow: 3px 3px 15px rgba(0,0,0,0.1); }
        .float-ad:hover { width: 200px; padding: 10px; left: 0; }
        .float-icon { font-size: 1.4rem; color: var(--red); margin-right: 8px; animation: wig 2s infinite; min-width: 30px; text-align: center; }
        .float-txt { display: none; font-size: 0.75rem; white-space: nowrap; font-weight: bold; color: var(--dark); }
        .float-ad:hover .float-txt { display: block; }
        @keyframes wig { 0%, 100% { transform: rotate(-10deg); } 50% { transform: rotate(10deg); } }

        /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 4000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: #fff; width: 95%; max-width: 450px; border-radius: 25px; padding: 0; position: relative; max-height: 90vh; overflow-y: auto; animation: pop 0.3s; padding-bottom: 20px; }
        .modal-close { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.5); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10; font-weight: bold; }
        @keyframes pop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .d-body { padding: 20px; }
        .d-title { margin: 0 0 10px; font-size: 1.5rem; font-weight: 900; color: var(--dark); }
        .cat-capsule { display: inline-block; background: var(--dark); color: white; padding: 5px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; margin-bottom: 15px; box-shadow: 0 3px 8px rgba(0,0,0,0.1); }
        .d-desc { line-height: 1.7; color: #666; font-size: 0.95rem; margin: 15px 0; background: #f9f9f9; padding: 15px; border-radius: 15px; border: 1px solid #eee; }
        .action-btns { display: flex; gap: 10px; margin-top: 20px; }
        .btn-act { flex: 1; padding: 14px; border-radius: 15px; text-align: center; color: white; font-weight: bold; text-decoration: none; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-call { background: #3498db; } .btn-wa { background: #25D366; }
        
        .form-input, .form-select { width: 100%; padding: 14px; margin-bottom: 12px; border: 1px solid #ddd; border-radius: 12px; font-family: 'Tajawal'; background: #f9f9f9; font-size: 0.95rem; }
        .btn-submit { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 1.1rem; }
        
        .admin-actions { display: flex; gap: 10px; margin-top: 10px; }
        .btn-approve { background: var(--primary); color: white; flex: 1; border: none; padding: 8px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-reject { background: var(--red); color: white; flex: 1; border: none; padding: 8px; border-radius: 8px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div id="splashScreen" onclick="removeSplash()">
    <div class="rocket-icon"><i class="fas fa-rocket"></i></div>
    <div class="splash-text">Hona App</div>
</div>

<div class="ticker-container">
    <div class="news-bar" id="newsBar" style="display:none"><div class="ticker-lbl lbl-news">Ø£Ø®Ø¨Ø§Ø±</div><div class="track" id="newsText"></div></div>
    <div class="ads-bar" id="adsBar"><div class="ticker-lbl lbl-ads">ğŸ”¥ Ø¹Ø±ÙˆØ¶</div><div class="track" id="adsText"></div></div>
</div>

<div class="float-ad" id="floatAd" style="display:none" onclick="openFloatAd()"><div class="float-icon"><i class="fas fa-gift"></i></div><div class="float-txt" id="floatTxt"></div></div>

<header>
    <div class="logo-area" onclick="triggerAdmin()">
        <div class="geo-logo"><i class="fas fa-city"></i></div>
        <div class="app-title"><h1>Hona</h1><p>Ù…Ø¬ØªÙ…Ø¹ Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§ØµÙ…Ø©</p></div>
    </div>
    <div class="header-icons">
        <div class="shop-counter-box"><span class="shop-counter-num" id="shopCount">0</span><span class="shop-counter-lbl">Ø®Ø¯Ù…Ø©</span></div>
        <i class="fas fa-sync-alt icon-btn" onclick="forceUpdate()"></i>
        <i class="fas fa-info-circle icon-btn" onclick="openModal('aboutModal')"></i>
        <i class="fas fa-ambulance icon-btn" onclick="openModal('emergencyModal')" style="color:#ff6b6b"></i>
    </div>
</header>

<div id="mainView">
    <div class="search-wrap">
        <input type="text" id="search" class="search-inp" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù†..." oninput="doSearch(this.value)">
        <i class="fas fa-search search-btn" onclick="doSearch(document.getElementById('search').value)"></i>
    </div>

    <div class="quick-filters">
        <div class="q-chip" onclick="filter('featured', this)"><i class="fas fa-fire"></i> Ø§Ù„Ù…Ù…ÙŠØ²</div>
        <div class="q-chip" onclick="filter('latest', this)"><i class="fas fa-clock"></i> Ø§Ù„Ø£Ø­Ø¯Ø«</div>
    </div>

    <div class="cat-grid">
        <div class="cat-item active" onclick="filter('all', this)"><div class="cat-icon bg-all"><i class="fas fa-th"></i></div><div class="cat-name">Ø§Ù„ÙƒÙ„</div></div>
        <div class="cat-item" onclick="filter('Ø£Ø®Ø¨Ø§Ø±', this)"><div class="cat-icon bg-news"><i class="fas fa-newspaper"></i></div><div class="cat-name">Ø£Ø®Ø¨Ø§Ø±</div></div>
        <div class="cat-item" onclick="filter('Ù…ØµØ§Ù„Ø­ Ø­ÙƒÙˆÙ…ÙŠØ©', this)"><div class="cat-icon bg-gov"><i class="fas fa-landmark"></i></div><div class="cat-name">Ù…ØµØ§Ù„Ø­<br>Ø­ÙƒÙˆÙ…ÙŠØ©</div></div>
        <div class="cat-item" onclick="filter('Ø¯ÙˆØ± Ø¹Ø¨Ø§Ø¯Ø©', this)"><div class="cat-icon bg-worship"><i class="fas fa-mosque"></i></div><div class="cat-name">Ø¯ÙˆØ±<br>Ø¹Ø¨Ø§Ø¯Ø©</div></div>
        <div class="cat-item" onclick="filter('ØªØ¹Ù„ÙŠÙ… ÙˆØ­Ø¶Ø§Ù†Ø§Øª', this)"><div class="cat-icon bg-school"><i class="fas fa-graduation-cap"></i></div><div class="cat-name">ØªØ¹Ù„ÙŠÙ…</div></div>
        <div class="cat-item" onclick="filter('Ù…Ø·Ø§Ø¹Ù… ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª', this)"><div class="cat-icon bg-food"><i class="fas fa-utensils"></i></div><div class="cat-name">Ù…Ø·Ø§Ø¹Ù…</div></div>
        <div class="cat-item" onclick="filter('Ù…Ø§Ø±ÙƒØª ÙˆØ¹Ø·Ø§Ø±Ø©', this)"><div class="cat-icon bg-market"><i class="fas fa-shopping-basket"></i></div><div class="cat-name">Ù…Ø§Ø±ÙƒØª</div></div>
        <div class="cat-item" onclick="filter('ØµÙŠØ§Ù†Ø© Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©', this)"><div class="cat-icon bg-home"><i class="fas fa-plug"></i></div><div class="cat-name">ØµÙŠØ§Ù†Ø©</div></div>
        <div class="cat-item" onclick="filter('ÙÙ†ÙŠÙŠÙ† ÙˆØ­Ø±Ù', this)"><div class="cat-icon bg-techs"><i class="fas fa-hammer"></i></div><div class="cat-name">Ø­Ø±Ù</div></div>
        <div class="cat-item" onclick="filter('Ø®Ø¯Ù…Ø§Øª Ø·Ø¨ÙŠØ©', this)"><div class="cat-icon bg-med"><i class="fas fa-user-md"></i></div><div class="cat-name">Ø·Ø¨ÙŠØ©</div></div>
        <div class="cat-item" onclick="filter('Ù…ÙˆØ§ØµÙ„Ø§Øª', this)"><div class="cat-icon bg-transport"><i class="fas fa-bus"></i></div><div class="cat-name">Ù…ÙˆØ§ØµÙ„Ø§Øª</div></div>
        <div class="cat-item" onclick="filter('ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', this)"><div class="cat-icon bg-tech"><i class="fas fa-mobile-alt"></i></div><div class="cat-name">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§</div></div>
        <div class="cat-item" onclick="filter('Ø³ÙŠØ§Ø±Ø§Øª ÙˆØ¯Ø±Ø§Ø¬Ø§Øª', this)"><div class="cat-icon bg-auto"><i class="fas fa-car"></i></div><div class="cat-name">Ø³ÙŠØ§Ø±Ø§Øª</div></div>
        <div class="cat-item" onclick="filter('Ù…Ù„Ø§Ø¨Ø³ ÙˆØ£Ø­Ø°ÙŠØ©', this)"><div class="cat-icon bg-fashion"><i class="fas fa-tshirt"></i></div><div class="cat-name">Ù…Ù„Ø§Ø¨Ø³</div></div>
        <div class="cat-item" onclick="filter('Ù…Ù†Ø¸ÙØ§Øª ÙˆØªØ¬Ù…ÙŠÙ„', this)"><div class="cat-icon bg-clean"><i class="fas fa-spray-can"></i></div><div class="cat-name">ØªØ¬Ù…ÙŠÙ„</div></div>
        <div class="cat-item" onclick="filter('Ø¯ÙŠÙƒÙˆØ±Ø§Øª', this)"><div class="cat-icon bg-decor"><i class="fas fa-paint-roller"></i></div><div class="cat-name">Ø¯ÙŠÙƒÙˆØ±Ø§Øª</div></div>
        <div class="cat-item" onclick="filter('Ø±ÙŠØ§Ø¶Ø©', this)"><div class="cat-icon bg-sport"><i class="fas fa-dumbbell"></i></div><div class="cat-name">Ø±ÙŠØ§Ø¶Ø©</div></div>
        <div class="cat-item" onclick="filter('Ø£Ø®Ø±Ù‰', this)"><div class="cat-icon bg-other"><i class="fas fa-ellipsis-h"></i></div><div class="cat-name">Ø£Ø®Ø±Ù‰</div></div>
    </div>

    <div id="subCatNav" class="sub-cat-nav"></div>

    <div class="grid" id="grid">
        <div style="text-align:center; padding:50px; grid-column:span 2; color:#ccc;"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
    <div id="loadMore" style="text-align:center; padding:20px; display:none;"><button class="btn-submit" style="width:auto; background:#eee; color:#333;" onclick="renderMore()">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ ğŸ‘‡</button></div>
</div>

<div class="btm-nav">
    <div class="btm-item active" onclick="resetApp()"><i class="fas fa-home"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
    <div class="btm-item" onclick="filter('offers', null)"><i class="fas fa-tags"></i>Ø§Ù„Ø¹Ø±ÙˆØ¶</div>
    <div style="width:50px"></div>
    <div class="btm-item" onclick="filter('fav', null)"><i class="fas fa-heart"></i>Ø§Ù„Ù…ÙØ¶Ù„Ø©</div>
    <div class="btm-item" onclick="filter('souq', null)"><i class="fas fa-handshake"></i>Ø§Ù„Ø³ÙˆÙ‚</div>
</div>
<div class="fab" onclick="openFormClean()"><i class="fas fa-plus"></i></div>

<div id="emergencyModal" class="modal"><div class="modal-content" style="padding:20px;"><div class="modal-close" onclick="closeModal('emergencyModal')">âœ•</div><h3 style="text-align:center; color:var(--red);">ğŸš¨ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h3><ul style="list-style:none; padding:0; line-height:2.5;"><li>ğŸš“ Ø§Ù„Ù†Ø¬Ø¯Ø©: <a href="tel:122">122</a></li><li>ğŸš‘ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù: <a href="tel:123">123</a></li><li>ğŸš’ Ø§Ù„Ù…Ø·Ø§ÙØ¦: <a href="tel:180">180</a></li><li>âš¡ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡: <a href="tel:121">121</a></li><li>ğŸš° Ø§Ù„Ù…ÙŠØ§Ù‡: <a href="tel:125">125</a></li><li>ğŸ”¥ Ø§Ù„ØºØ§Ø²: <a href="tel:129">129</a></li></ul></div></div>
<div id="aboutModal" class="modal"><div class="modal-content" style="text-align:center; padding:30px;"><div class="modal-close" onclick="closeModal('aboutModal')">âœ•</div><h3>Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3><p>Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø®Ø¯Ù…ÙŠ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§ØµÙ…Ø©.</p><p style="color:var(--primary);">Ù†Ø³Ø£Ù„ÙƒÙ… Ø§Ù„Ø¯Ø¹Ø§Ø¡ â¤ï¸</p></div></div>

<div id="formModal" class="modal"><div class="modal-content" style="padding:20px;">
    <div class="modal-close" onclick="closeModal('formModal')">âœ•</div>
    <h3 style="text-align:center;">Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯</h3>
    <form id="reqForm" onsubmit="sendData(event)">
        <select name="Type" id="reqType" class="form-select" onchange="toggleFields(this.value)">
            <option value="Ù†Ø´Ø§Ø·">ğŸ“ Ù†Ø´Ø§Ø· / Ù…Ø­Ù„</option>
            <option value="Ø¥Ø¹Ù„Ø§Ù†">ğŸ“¢ Ø¥Ø¹Ù„Ø§Ù† Ù…Ù…ÙŠØ²</option>
            <option value="Ø¨ÙŠØ¹ Ø³Ù„Ø¹Ø© / Ù…Ø³ØªØ¹Ù…Ù„">ğŸ’° Ø¨ÙŠØ¹ Ù…Ø³ØªØ¹Ù…Ù„</option>
            <option value="Ù…Ø®Ø§Ù„ÙØ©">âš ï¸ Ø¥Ø¨Ù„Ø§Øº Ù…Ø®Ø§Ù„ÙØ©</option>
            <option value="Ø§Ù‚ØªØ±Ø§Ø­">ğŸ’¡ Ø§Ù‚ØªØ±Ø§Ø­</option>
        </select>
        <input type="text" name="Name" id="inp_Name" class="form-input" placeholder="Ø§Ù„Ø§Ø³Ù… / Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" required>
        
        <div id="catDiv">
            <select name="Category" id="inp_Category" class="form-select" onchange="checkSub(this.value)">
                <option value="">Ø§Ù„ØªØµÙ†ÙŠÙ...</option>
                <option value="Ù…Ø·Ø§Ø¹Ù… ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª">Ù…Ø·Ø§Ø¹Ù… ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª</option>
                <option value="Ù…Ø§Ø±ÙƒØª ÙˆØ¹Ø·Ø§Ø±Ø©">Ù…Ø§Ø±ÙƒØª ÙˆØ¹Ø·Ø§Ø±Ø©</option>
                <option value="ØµÙŠØ§Ù†Ø© Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©">ØµÙŠØ§Ù†Ø© Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©</option>
                <option value="ÙÙ†ÙŠÙŠÙ† ÙˆØ­Ø±Ù">ÙÙ†ÙŠÙŠÙ† ÙˆØ­Ø±Ù</option>
                <option value="Ø®Ø¯Ù…Ø§Øª Ø·Ø¨ÙŠØ©">Ø®Ø¯Ù…Ø§Øª Ø·Ø¨ÙŠØ©</option>
                <option value="ØªØ¹Ù„ÙŠÙ… ÙˆØ­Ø¶Ø§Ù†Ø§Øª">ØªØ¹Ù„ÙŠÙ… ÙˆØ­Ø¶Ø§Ù†Ø§Øª</option>
                <option value="Ø³ÙŠØ§Ø±Ø§Øª ÙˆØ¯Ø±Ø§Ø¬Ø§Øª">Ø³ÙŠØ§Ø±Ø§Øª ÙˆØ¯Ø±Ø§Ø¬Ø§Øª</option>
                <option value="ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
                <option value="Ù…Ù„Ø§Ø¨Ø³ ÙˆØ£Ø­Ø°ÙŠØ©">Ù…Ù„Ø§Ø¨Ø³ ÙˆØ£Ø­Ø°ÙŠØ©</option>
                <option value="Ù…Ù†Ø¸ÙØ§Øª ÙˆØªØ¬Ù…ÙŠÙ„">Ù…Ù†Ø¸ÙØ§Øª ÙˆØªØ¬Ù…ÙŠÙ„</option>
                <option value="Ø¯ÙŠÙƒÙˆØ±Ø§Øª">Ø¯ÙŠÙƒÙˆØ±Ø§Øª</option>
                <option value="Ù…ÙˆØ§ØµÙ„Ø§Øª">Ù…ÙˆØ§ØµÙ„Ø§Øª</option>
                <option value="Ø±ÙŠØ§Ø¶Ø©">Ø±ÙŠØ§Ø¶Ø©</option>
                <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                <option value="Ù…ØµØ§Ù„Ø­ Ø­ÙƒÙˆÙ…ÙŠØ©" style="color:red; font-weight:bold; display:none;" id="opt_gov">Ù…ØµØ§Ù„Ø­ Ø­ÙƒÙˆÙ…ÙŠØ©</option>
                <option value="Ø¯ÙˆØ± Ø¹Ø¨Ø§Ø¯Ø©" style="color:red; font-weight:bold; display:none;" id="opt_worship">Ø¯ÙˆØ± Ø¹Ø¨Ø§Ø¯Ø©</option>
                <option value="Ø£Ø®Ø¨Ø§Ø±" style="color:red; font-weight:bold; display:none;" id="opt_news">Ø£Ø®Ø¨Ø§Ø±</option>
            </select>
            <select name="SubCategorySelect" id="subCatSelect" class="form-select" style="display:none;"></select>
            <input type="text" name="SubCategoryInput" id="subCatInput" class="form-input" placeholder="Ø§Ù„ØªØ®ØµØµ..." style="display:none;">
        </div>

        <div id="usedDiv" style="display:none;">
            <select name="UsedCategory" class="form-select"><option value="">Ù†ÙˆØ¹ Ø§Ù„Ø³Ù„Ø¹Ø©...</option><option value="Ø£Ø«Ø§Ø«">Ø£Ø«Ø§Ø«</option><option value="Ø£Ø¬Ù‡Ø²Ø©">Ø£Ø¬Ù‡Ø²Ø©</option><option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option></select>
        </div>

        <input type="text" name="Area" id="inp_Area" class="form-input" placeholder="Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
        <input type="text" name="Location" id="inp_Loc" class="form-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù„ÙˆÙƒÙŠØ´Ù†">
        <input type="text" name="Image" id="inp_Img" class="form-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
        
        <div id="offerSection" style="display:none; gap:5px;">
            <input type="text" name="Offer" class="form-input" placeholder="Ø§Ù„Ø¹Ø±Ø¶" style="flex:2;">
            <input type="text" id="offerExpiry" class="form-input" placeholder="ØªØ§Ø±ÙŠØ®: 20/12" style="flex:1;">
        </div>

        <textarea name="Description" class="form-input" placeholder="Ø§Ù„ÙˆØµÙ" required></textarea>
        <input type="text" name="Contact" class="form-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„" required>
        <button type="submit" id="submitBtn" class="btn-submit">Ø¥Ø±Ø³Ø§Ù„ ğŸš€</button>
    </form>
</div></div>

<div id="detailsModal" class="modal" onclick="if(event.target==this)closeModal('detailsModal')">
    <div class="modal-content">
        <div class="modal-close" onclick="closeModal('detailsModal')">âœ•</div>
        <div id="imgSlider" class="img-slider"></div>
        <div class="d-body">
            <h2 id="dName" class="d-title"></h2>
            <div><span class="cat-capsule" id="dCat"></span></div>
            <div id="dArea" style="color:#777; margin:5px 0;"></div>
            <div id="dOfferBox" class="card-offer-visible" style="display:none;"></div>
            <div id="dDesc" class="d-desc"></div>
            <div class="action-btns" id="actionBtns"></div>
        </div>
    </div>
</div>

<div id="adminModal" class="modal"><div class="modal-content" style="padding:20px;">
    <div class="modal-close" onclick="closeModal('adminModal')">âœ•</div>
    <h3 style="text-align:center;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
    <div id="adminContent">
        <input type="password" id="adminPass" class="form-input" placeholder="Password">
        <button onclick="loadPending()" class="btn-submit">Ø¯Ø®ÙˆÙ„</button>
    </div>
    <div id="pendingList" style="margin-top:15px;"></div>
</div></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    // ğŸ”´ğŸ”´ğŸ”´ Ø¶Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§ ğŸ”´ğŸ”´ğŸ”´
    const scriptURL = 'https://script.google.com/macros/s/AKfycbysVrdnoo4HhqfrJyquwc0kb2H-kHBbVxuB-Ji8TGG5z-fpC5wrKmdAks9fXLPav6D58A/exec';
    
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´ÙŠØª Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø£ØµÙ„ÙŠØ©)
    const sheet = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQxk-tGJ65-hOGtlnVUHDmDUohw1zFIFLDlIng-OlmH35mti_kqInGBCl3gNpUUeL9j5VRMx_x7A8bn/pub?gid=965965865&single=true&output=csv";
    const proxy = "https://corsproxy.io/?" + encodeURIComponent(sheet);
    const DEFAULT_IMG = "data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 24 24' fill='none' stroke='%2327ae60' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 21h18M5 21V7l8-4 8 4v14'/%3E%3Cpath d='M9 10a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v11H9V10Z'/%3E%3C/svg%3E";
    
    // âœ… Ù…ÙØªØ§Ø­ ØªØ®Ø²ÙŠÙ† Ù„Ù„Ù†Ø³Ø®Ø© V178
    const FAV_KEY = 'hona_favs_v178_final';
    let fullDB = [], filteredDB = [], curCat = 'all', page = 1, limit = 12, favs = JSON.parse(localStorage.getItem(FAV_KEY)) || [], adminClicks = 0, floatAdID = null;

    const subCategories = {"Ù…Ø·Ø§Ø¹Ù… ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª":["Ù…Ø´ÙˆÙŠØ§Øª","ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©","ÙƒØ´Ø±ÙŠ","Ø³ÙˆØ±ÙŠ","Ø¨ÙŠØªØ²Ø§","Ø³Ù…Ùƒ","Ù…Ø®Ø¨Ø²","ÙƒØ§ÙÙŠÙ‡"],"Ø®Ø¯Ù…Ø§Øª Ø·Ø¨ÙŠØ©":["ØµÙŠØ¯Ù„ÙŠØ©","Ù…Ø¹Ù…Ù„","Ø¹ÙŠØ§Ø¯Ø©","Ù…Ø³ØªØ´ÙÙ‰"],"ÙÙ†ÙŠÙŠÙ† ÙˆØ­Ø±Ù":["Ø³Ø¨Ø§Ùƒ","ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ","Ù†Ø¬Ø§Ø±","Ù†Ù‚Ø§Ø´","ØªÙƒÙŠÙŠÙ","Ø£Ù„ÙˆÙ…ÙŠØªØ§Ù„"],"Ù…Ø§Ø±ÙƒØª ÙˆØ¹Ø·Ø§Ø±Ø©":["Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª","Ø®Ø¶Ø§Ø±","Ø¬Ø²Ø§Ø±Ø©","Ø¹Ø·Ø§Ø±Ø©"],"ØµÙŠØ§Ù†Ø© Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©":["ØºØ³Ø§Ù„Ø§Øª","Ø«Ù„Ø§Ø¬Ø§Øª","ØªÙƒÙŠÙŠÙØ§Øª"],"ØªØ¹Ù„ÙŠÙ… ÙˆØ­Ø¶Ø§Ù†Ø§Øª":["Ø­Ø¶Ø§Ù†Ø©","Ù…Ø¯Ø±Ø³Ø©","Ø³Ù†ØªØ±","Ù…ÙƒØªØ¨Ø©"],"Ø£Ø®Ø±Ù‰":[]};

    function init() {
        setTimeout(removeSplash, 1000);
        Papa.parse(proxy, { download: true, header: false, skipEmptyLines: true, complete: (res) => {
            fullDB = res.data.slice(1).map((r, i) => ({
                id: String(r[0] || i), 
                name: r[1], cat: r[2], sub: r[3], area: r[4], desc: r[5],
                ph: r[6], wa: r[7], img: r[8], loc: r[9], offer: r[10],
                live: String(r[11]) === 'TRUE', feat: String(r[12]) === 'TRUE',
                date: r[13], src: r[14], rating: r[16]
            })).reverse();
            
            setupTickers();
            setupFloatAd();
            renderGrid(true);
            document.getElementById('shopCount').innerText = fullDB.filter(x=>x.cat!=='Ø£Ø®Ø¨Ø§Ø±').length;
            removeSplash();
        }});
    }

    // ğŸŸ¢ Ø¯ÙˆØ§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø­Ø¯Ø«Ø© Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„)
    window.loadPending = function() {
        const pass = document.getElementById('adminPass').value;
        const btn = document.querySelector('#adminContent .btn-submit');
        const list = document.getElementById('pendingList');
        
        if(!pass) { alert("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"); return; }
        if(btn) btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
        list.innerHTML = '<div style="text-align:center; padding:20px; color:#555;"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
        
        const params = new URLSearchParams();
        params.append('action', 'getPending');
        params.append('pass', pass);

        fetch(scriptURL, { method: 'POST', body: params })
        .then(r => r.json())
        .then(res => {
            if(btn) btn.innerText = "Ø¯Ø®ÙˆÙ„";
            if(res.result === 'error') {
                list.innerHTML = `<p style="color:red; text-align:center;">âŒ ${res.error}</p>`;
            } else {
                if(res.data.length === 0) {
                    list.innerHTML = '<p style="text-align:center; padding:20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© âœ…</p>';
                } else {
                    list.innerHTML = res.data.map(item => `
                        <div class="card" id="row-${item.row}" style="margin-bottom:10px; padding:10px; border-right:4px solid var(--gold);">
                            <div class="c-title">${item.name} <small style="font-weight:normal; font-size:0.7rem;">(${item.type})</small></div>
                            <div class="c-sub">${item.cat}</div>
                            <div style="font-size:0.8rem;color:#666;margin:5px 0;">${item.desc}</div>
                            <div class="admin-actions">
                                <button class="btn-approve" onclick="doAction('approve', ${item.row}, this)">âœ… Ù…ÙˆØ§ÙÙ‚Ø©</button>
                                <button class="btn-reject" onclick="doAction('reject', ${item.row}, this)">âŒ Ø±ÙØ¶</button>
                            </div>
                        </div>`).join('');
                }
            }
        })
        .catch(err => {
            if(btn) btn.innerText = "Ø¯Ø®ÙˆÙ„";
            list.innerHTML = '<p style="color:red; text-align:center;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±</p>';
        });
    }

    window.doAction = function(actionType, rowIdx, btnElem) {
        if(!confirm(actionType === 'approve' ? "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©ØŸ" : "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°ÙØŸ")) return;
        const pass = document.getElementById('adminPass').value;
        const originalText = btnElem.innerText;
        btnElem.innerText = "â³..."; 
        btnElem.disabled = true;
        const cardRow = document.getElementById(`row-${rowIdx}`);
        if(cardRow) cardRow.style.opacity = '0.5';

        const params = new URLSearchParams();
        params.append('action', actionType);
        params.append('row', rowIdx);
        params.append('pass', pass);
        
        fetch(scriptURL, { method: 'POST', body: params })
        .then(r => r.json())
        .then(res => {
            if(res.result === 'success') {
                if(cardRow) { cardRow.style.display = 'none'; cardRow.remove(); }
            } else {
                alert("Ø®Ø·Ø£: " + res.error);
                btnElem.innerText = originalText;
                btnElem.disabled = false;
                if(cardRow) cardRow.style.opacity = '1';
            }
        })
        .catch(err => {
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„");
            btnElem.innerText = originalText;
            btnElem.disabled = false;
            if(cardRow) cardRow.style.opacity = '1';
        });
    }

    function removeSplash() { const s = document.getElementById('splashScreen'); if(s) { s.style.opacity='0'; setTimeout(()=>s.style.display='none',500); } }
    function openFormClean() { document.getElementById('formModal').style.display='flex'; }
    function closeModal(id) { document.getElementById(id).style.display='none'; }
    function openModal(id) { document.getElementById(id).style.display='flex'; }
    function triggerAdmin() { adminClicks++; if(adminClicks===5) { adminClicks=0; openModal('adminModal'); } }
    function forceUpdate() { localStorage.removeItem(FAV_KEY); window.location.reload(); }
    function resetApp() { document.getElementById('search').value=''; document.querySelectorAll('.q-chip').forEach(q => q.classList.remove('active')); filter('all', document.querySelector('.cat-item')); window.scrollTo({ top: 0, behavior: 'smooth' }); }

    function sendData(e) {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
        btn.disabled = true;
        
        const form = document.getElementById('reqForm');
        const formData = new FormData(form);
        const data = {};
        formData.forEach((v,k) => data[k] = v);
        
        if(data.Offer && document.getElementById('offerExpiry').value) {
            data.Offer += ` {${document.getElementById('offerExpiry').value}}`;
        }
        let finalSub = data.SubCategorySelect || data.SubCategoryInput || "";
        if (document.getElementById('usedDiv').style.display !== 'none') { data.Category = "Ø¨ÙŠØ¹ Ø³Ù„Ø¹Ø© / Ù…Ø³ØªØ¹Ù…Ù„"; finalSub = data.UsedCategory; }

        const params = new URLSearchParams();
        params.append("Date", "New");
        params.append("Type", data.Type);
        params.append("Name", data.Name);
        params.append("Category", data.Category);
        params.append("SubCategory", finalSub);
        params.append("Area", data.Area);
        params.append("Description", data.Description);
        params.append("Contact", data.Contact);
        params.append("Whatsapp", data.Whatsapp);
        params.append("Image", data.Image);
        params.append("Location", data.Location);
        params.append("Offer", data.Offer || "");
        
        fetch(scriptURL, { method:'POST', body:params })
        .then(r => r.json())
        .then(res => {
            alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!");
            closeModal('formModal');
            btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ ğŸš€";
            btn.disabled = false;
            form.reset();
        })
        .catch(err => { alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„!"); closeModal('formModal'); btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ ğŸš€"; btn.disabled = false; });
    }

    function renderGrid(newSearch) {
        const grid = document.getElementById('grid');
        const loadBtn = document.getElementById('loadMore');
        if(newSearch) { grid.innerHTML = ''; page=1; }
        
        const start = (page-1)*limit;
        const end = page*limit;
        const chunk = filteredDB.slice(start, end);
        
        if(chunk.length === 0 && page === 1) {
            grid.innerHTML = '<div style="text-align:center; padding:40px; color:#999; grid-column:span 2;"><i class="fas fa-search" style="font-size:3rem; margin-bottom:10px;"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';
            loadBtn.style.display = 'none';
            return;
        }

        chunk.forEach(item => {
            const isNews = item.cat === 'Ø£Ø®Ø¨Ø§Ø±';
            const isFav = favs.includes(item.id) ? 'active' : '';
            const img = (item.img && item.img.length>5) ? item.img : DEFAULT_IMG;
            
            let offerHTML = '';
            if(item.offer && isOfferValid(item.offer)) {
                let txt = item.offer.replace(/\{.*?\}/, ''); 
                offerHTML = `<div class="card-offer-visible">ğŸ”¥ ${txt}</div>`;
            }

            const card = document.createElement('div');
            card.className = `card ${item.feat?'featured':''} ${isNews?'news-card':''}`;
            card.onclick = () => openD(item.id);
            
            card.innerHTML = `
                <div class="card-fav-btn ${isFav}" onclick="toggleFav(event, '${item.id}')"><i class="fas fa-heart"></i></div>
                ${item.feat ? '<div class="badge-feat">Ù…Ù…ÙŠØ²</div>' : ''}
                <img src="${img}" class="c-img" loading="lazy">
                <div class="c-body">
                    <div class="c-title">${item.name}</div>
                    ${!isNews ? `<div class="c-sub"><i class="fas fa-tag"></i> ${item.cat}</div>` : ''}
                    ${!isNews ? `<div class="c-sub"><i class="fas fa-map-marker-alt"></i> ${item.area||''}</div>` : ''}
                    ${offerHTML}
                    ${item.date ? `<div style="font-size:0.6rem; color:#999; margin-top:5px; border-top:1px dashed #eee; padding-top:5px;">${item.date}</div>` : ''}
                </div>
            `;
            grid.appendChild(card);
        });
        
        loadBtn.style.display = (end < filteredDB.length) ? 'block' : 'none';
        if (newSearch && chunk.length > 0) page++;
    }

    function toggleFav(e, id) { e.stopPropagation(); const strId = String(id); if(favs.includes(strId)) favs = favs.filter(x => x !== strId); else favs.push(strId); localStorage.setItem(FAV_KEY, JSON.stringify(favs)); e.currentTarget.classList.toggle('active'); if(curCat === 'fav') filter('fav', null); }
    function isOfferValid(txt) { if(!txt) return false; let match = txt.match(/\{(\d{1,2})[\/\-](\d{1,2})\}/); if(!match) return true; const d = parseInt(match[1]), m = parseInt(match[2]) - 1, year = new Date().getFullYear(); return new Date() <= new Date(year, m, d, 23, 59, 59); }
    function renderMore() { renderGrid(false); }
    function checkSub(val) { const subList = subCategories[val]; const subSel = document.getElementById('subCatSelect'); const subInp = document.getElementById('subCatInput'); if(subList && subList.length > 0) { subSel.style.display = 'block'; subInp.style.display = 'none'; subSel.innerHTML = subList.map(s => `<option value="${s}">${s}</option>`).join(''); } else { subSel.style.display = 'none'; subInp.style.display = (val==='Ø£Ø®Ø±Ù‰') ? 'block' : 'none'; } }
    function toggleFields(val) { const cat = document.getElementById('catDiv'); const used = document.getElementById('usedDiv'); const offer = document.getElementById('offerSection'); cat.style.display = (val === 'Ù†Ø´Ø§Ø·' || val === 'Ø¥Ø¹Ù„Ø§Ù†') ? 'block' : 'none'; used.style.display = (val === 'Ø¨ÙŠØ¹ Ø³Ù„Ø¹Ø© / Ù…Ø³ØªØ¹Ù…Ù„') ? 'block' : 'none'; offer.style.display = (val === 'Ø¥Ø¹Ù„Ø§Ù†') ? 'flex' : 'none'; 
        // Admin Options Toggle
        const isAdmin = val === 'Ø®Ø¨Ø±'; // Logic placeholder
        document.getElementById('opt_gov').style.display = 'none';
        document.getElementById('opt_worship').style.display = 'none'; 
        document.getElementById('opt_news').style.display = 'none';
    }
    function filter(type, el) { curCat = type; document.querySelectorAll('.cat-item, .btm-item, .q-chip').forEach(x => x.classList.remove('active')); if(el) el.classList.add('active'); if(type === 'all') filteredDB = fullDB.filter(x => x.cat !== 'Ø£Ø®Ø¨Ø§Ø±'); else if(type === 'fav') filteredDB = fullDB.filter(x => favs.includes(x.id)); else if(type === 'offers') filteredDB = fullDB.filter(x => x.offer && isOfferValid(x.offer)); else if(type === 'featured') filteredDB = fullDB.filter(x => x.feat); else if(type === 'latest') filteredDB = [...fullDB.filter(x=>x.cat!=='Ø£Ø®Ø¨Ø§Ø±')].sort((a,b)=>b.id-a.id); else if(type === 'souq') filteredDB = fullDB.filter(x => x.cat === 'Ø¨ÙŠØ¹ Ø³Ù„Ø¹Ø© / Ù…Ø³ØªØ¹Ù…Ù„'); else filteredDB = fullDB.filter(x => x.cat === type); renderGrid(true); }
    function doSearch(val) { if(!val) { filter('all', document.querySelector('.cat-item')); return; } filteredDB = fullDB.filter(x => x.name.includes(val) || x.desc.includes(val)); renderGrid(true); }
    function setupTickers() { const news = fullDB.filter(x => x.cat === 'Ø£Ø®Ø¨Ø§Ø±').slice(0,5).map(x => `<span class="ticker-item">ğŸ“° ${x.name}</span>`).join(''); if(news) { document.getElementById('newsBar').style.display = 'flex'; document.getElementById('newsText').innerHTML = `<div class="scrolling">${news}</div>`; } const ads = fullDB.filter(x => x.offer && isOfferValid(x.offer)).map(x => `<span class="ticker-item">ğŸ”¥ ${x.name}: ${x.offer.replace(/\{.*?\}/,'')}</span>`).join(''); if(ads) document.getElementById('adsText').innerHTML = `<div class="scrolling">${ads}</div>`; }
    function setupFloatAd() { const ads = fullDB.filter(x => x.feat && x.offer && isOfferValid(x.offer)); if(ads.length > 0) { const rand = ads[Math.floor(Math.random()*ads.length)]; floatAdID = rand.id; document.getElementById('floatTxt').innerText = rand.name; document.getElementById('floatAd').style.display = 'flex'; } }
    function openFloatAd() { if(floatAdID) openD(floatAdID); }
    function openD(id) { const item = fullDB.find(x => x.id === String(id)); if(!item) return; document.getElementById('dName').innerText = item.name; document.getElementById('dCat').innerText = item.cat; document.getElementById('dDesc').innerText = item.desc; document.getElementById('dArea').innerText = item.area || ""; const slider = document.getElementById('imgSlider'); const imgUrl = (item.img && item.img.length>5) ? item.img : DEFAULT_IMG; slider.innerHTML = `<img src="${imgUrl}" style="width:100%; height:100%; object-fit:cover;">`; const btns = document.getElementById('actionBtns'); btns.innerHTML = ''; if(item.ph) btns.innerHTML += `<a href="tel:${item.ph}" class="btn-act btn-call">Ø§ØªØµØ§Ù„</a>`; if(item.wa) btns.innerHTML += `<a href="https://wa.me/2${item.wa}" class="btn-act btn-wa">ÙˆØ§ØªØ³Ø§Ø¨</a>`; if(item.loc) btns.innerHTML += `<a href="${item.loc}" class="btn-act" style="background:#f39c12;color:black;">Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>`; document.getElementById('detailsModal').style.display = 'flex'; }

    init();
</script>
</body>
</html>
